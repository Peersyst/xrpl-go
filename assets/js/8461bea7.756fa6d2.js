"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[643],{6728:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"xrpl/rpc","title":"rpc","description":"Overview","source":"@site/docs/xrpl/rpc.md","sourceDirName":"xrpl","slug":"/xrpl/rpc","permalink":"/docs/xrpl/rpc","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/xrpl/rpc.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"queries","permalink":"/docs/xrpl/queries"},"next":{"title":"time","permalink":"/docs/xrpl/time"}}');var r=n(4848),s=n(8453);const o={},l="rpc",c={},a=[{value:"Overview",id:"overview",level:2},{value:"Client",id:"client",level:2},{value:"FaucetProvider",id:"faucetprovider",level:3},{value:"MaxFeeXRP",id:"maxfeexrp",level:3},{value:"FeeCushion",id:"feecushion",level:3},{value:"Methods",id:"methods",level:2},{value:"Request",id:"request",level:3},{value:"Submit/SubmitMultisigned",id:"submitsubmitmultisigned",level:3},{value:"Autofill/AutofillMultisigned",id:"autofillautofillmultisigned",level:3},{value:"SubmitAndWait",id:"submitandwait",level:3},{value:"Queries",id:"queries",level:2},{value:"Usage",id:"usage",level:2},{value:"Examples",id:"examples",level:2},{value:"How to send a payment transaction",id:"how-to-send-a-payment-transaction",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"rpc",children:"rpc"})}),"\n",(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"rpc"})," package provides the RPC client for interacting with the XRPL network via its RPC API. This client handles the communication with XRPL nodes, allowing you to:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Send requests to query the ledger state."}),"\n",(0,r.jsx)(t.li,{children:"Submit transactions to the network."}),"\n",(0,r.jsx)(t.li,{children:"Receive responses and handle errors."}),"\n",(0,r.jsx)(t.li,{children:"Manage the connections configuration."}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"client",children:"Client"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"rpc"})," package provides a ",(0,r.jsx)(t.code,{children:"Client"})," type of communication with XRPL nodes. This client is configurable and let the user submit transactions and make queries."]}),"\n",(0,r.jsxs)(t.p,{children:["In order to create a new ",(0,r.jsx)(t.code,{children:"Client"}),", you can use the ",(0,r.jsx)(t.code,{children:"NewClient"})," function:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'cfg, err := rpc.NewClientConfig("<url>")\nif err != nil {\n\t// ...\n}\nclient := rpc.NewClient(cfg)\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Every time you create a new ",(0,r.jsx)(t.code,{children:"Client"}),", you need to provde a ",(0,r.jsx)(t.code,{children:"Config"})," struct as an argument. You can initialize a ",(0,r.jsx)(t.code,{children:"Config"})," struct using the ",(0,r.jsx)(t.code,{children:"NewClientConfig"})," function."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"Config"})," struct follows the options pattern, so you can pass different options to the ",(0,r.jsx)(t.code,{children:"NewClientConfig"})," function."]}),"\n",(0,r.jsx)(t.h3,{id:"faucetprovider",children:"FaucetProvider"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"WithFaucetProvider"})," option allows you to set the faucet provider of the WebSocket client. There're two predefined faucet providers: ",(0,r.jsx)(t.code,{children:"TestnetFaucetProvider"})," and ",(0,r.jsx)(t.code,{children:"DevnetFaucetProvider"}),". You can also implement your own faucet provider by implementing the ",(0,r.jsx)(t.code,{children:"FaucetProvider"})," interface."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func (wc ClientConfig) WithFaucetProvider(fp common.FaucetProvider) ClientConfig\n"})}),"\n",(0,r.jsx)(t.h3,{id:"maxfeexrp",children:"MaxFeeXRP"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"WithMaxFeeXRP"})," option allows you to set the maximum fee in XRP that the client will use."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func (wc ClientConfig) WithMaxFeeXRP(maxFeeXRP float32) ClientConfig\n"})}),"\n",(0,r.jsx)(t.h3,{id:"feecushion",children:"FeeCushion"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"WithFeeCushion"})," option allows you to set the fee cushion for a transaction."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func (wc ClientConfig) WithFeeCushion(feeCushion float32) ClientConfig\n"})}),"\n",(0,r.jsxs)(t.p,{children:["So, for example, if you want to set a custom ",(0,r.jsx)(t.code,{children:"FaucetProvider"})," and ",(0,r.jsx)(t.code,{children:"FeeCushion"}),", you can do it this way:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'cfg, err := rpc.NewClientConfig("https://s.altnet.rippletest.net:51234/",\n\trpc.WithFaucetProvider(faucet.NewTestnetFaucetProvider()),\n\trpc.WithFeeCushion(1.5),\n)\nif err != nil {\n\t// ...\n}\nclient := rpc.NewClient(cfg)\n'})}),"\n",(0,r.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"Client"})," offers different methods to interact with the XRPL network."]}),"\n",(0,r.jsx)(t.h3,{id:"request",children:"Request"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Request"})," method is used to make queries to the XRPL network. It returns a ",(0,r.jsx)(t.code,{children:"XRPLResponse"})," interface. This method is used in the client's queries requests."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"// Client methods\nfunc (c *Client) Request(reqParams XRPLRequest) (XRPLResponse, error)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"submitsubmitmultisigned",children:"Submit/SubmitMultisigned"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Submit"})," method is used to submit a transaction to the XRPL network. It returns a ",(0,r.jsx)(t.code,{children:"TxResponse"})," struct containing the transaction result for the blob submitted. ",(0,r.jsx)(t.code,{children:"txBlob"})," must be signed. There's also a ",(0,r.jsx)(t.code,{children:"SubmitMultisigned"})," method that works the same way but for multisigned transactions."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func (c *Client) Submit(txBlob string, failHard bool) (*requests.TxResponse, error)\nfunc (c *Client) SubmitMultisigned(txBlob string, failHard bool) (*requests.SubmitMultisignedResponse, error)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"autofillautofillmultisigned",children:"Autofill/AutofillMultisigned"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"Autofill"})," method is used to autofill some fields in a flat transaction. This method is useful for adding dynamic fields like ",(0,r.jsx)(t.code,{children:"LastLedgerSequence"})," or ",(0,r.jsx)(t.code,{children:"Fee"}),". It returns an error if the transaction is not valid or some internall call fails. There's also a ",(0,r.jsx)(t.code,{children:"AutofillMultisigned"})," method that works the same way but for multisigned transactions."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func (c *Client) Autofill(tx *transaction.FlatTransaction) error\nfunc (c *Client) AutofillMultisigned(tx *transaction.FlatTransaction, nSigners uint64) error\n"})}),"\n",(0,r.jsx)(t.h3,{id:"submitandwait",children:"SubmitAndWait"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"SubmitAndWait"})," method is used to submit a transaction to the XRPL network and wait for it to be included in a ledger. It returns a ",(0,r.jsx)(t.code,{children:"TxResponse"})," struct containing the transaction result for the blob submitted."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"func (c *Client) SubmitAndWait(txBlob string, failHard bool) (*requests.TxResponse, error)\n"})}),"\n",(0,r.jsx)(t.h2,{id:"queries",children:"Queries"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"Client"})," also exposes methods to make queries to the XRPL network. These methods are wrappers of the queries requests exposed by the ",(0,r.jsx)(t.a,{href:"/docs/xrpl/queries",children:(0,r.jsx)(t.code,{children:"queries"})})," package."]}),"\n",(0,r.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(t.p,{children:["To use the ",(0,r.jsx)(t.code,{children:"rpc"})," package, you need to import it in your project:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'import "github.com/Peersyst/xrpl-go/xrpl/rpc"\n'})}),"\n",(0,r.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(t.h3,{id:"how-to-send-a-payment-transaction",children:"How to send a payment transaction"}),"\n",(0,r.jsxs)(t.p,{children:["This example shows how to send a payment transaction to the XRPL testnet with the ",(0,r.jsx)(t.code,{children:"rpc"})," package."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'package main\n\nimport (\n\t"fmt"\n\t"strconv"\n\n\t"github.com/Peersyst/xrpl-go/xrpl/currency"\n\t"github.com/Peersyst/xrpl-go/xrpl/faucet"\n\t"github.com/Peersyst/xrpl-go/xrpl/rpc"\n\t"github.com/Peersyst/xrpl-go/pkg/crypto"\n\t"github.com/Peersyst/xrpl-go/xrpl/transaction"\n\t"github.com/Peersyst/xrpl-go/xrpl/transaction/types"\n\t"github.com/Peersyst/xrpl-go/xrpl/wallet"\n)\n\nfunc main() {\n\n\t// Create a new rpc client config with a testnet faucet provider\n\tcfg, err := rpc.NewClientConfig(\n\t\t"https://s.altnet.rippletest.net:51234/",\n\t\trpc.WithMaxFeeXRP(5.0),\n\t\trpc.WithFeeCushion(1.5),\n\t\trpc.WithFaucetProvider(faucet.NewTestnetFaucetProvider()),\n\t)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\t// Create a new rpc client with the config\n\tclient := rpc.NewClient(cfg)\n\n\t// Create a new wallet with the ed25519 algorithm\n\tw, err := wallet.New(crypto.ED25519())\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\t// Fund the wallet with the testnet faucet\n\tif err := client.FundWallet(&w); err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\t// Convert the amount to drops\n\txrpAmount, err := currency.XrpToDrops("1")\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\txrpAmountInt, err := strconv.ParseInt(xrpAmount, 10, 64)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\tp := &transaction.Payment{\n\t\tBaseTx: transaction.BaseTx{\n\t\t\tAccount: types.Address(w.GetAddress()),\n\t\t},\n\t\tDestination: "rPT1Sjq2YGrBMTttX4GZHjKu9dyfzbpAYe",\n\t\tAmount:      types.XRPCurrencyAmount(xrpAmountInt),\n\t\tDeliverMax:  types.XRPCurrencyAmount(xrpAmountInt),\n\t}\n\n\tflattenedTx := p.Flatten()\n\n\t// Autofill the transaction with the client\'s config\n\tif err := client.Autofill(&flattenedTx); err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\t// Sign the transaction with the wallet\n\ttxBlob, _, err := w.Sign(flattenedTx)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\t// Submit the transaction to the network and wait for it to be included in a ledger\n\tres, err := client.SubmitAndWait(txBlob, false)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n}\n'})})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>l});var i=n(6540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);